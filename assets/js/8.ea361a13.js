(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{700:function(t,e,n){"use strict";(function(t){e.a={requestInPromise(e={}){const n=Object.assign({},{type:"GET",contentType:"application/json; charset=utf-8",data:{}},e);let o=this;return new Promise((function(e,i){let a=n.data;"POST"===n.type.toUpperCase()&&n.data&&n.contentType.indexOf("application/json")>-1&&(a=JSON.stringify(n.data)),t.ajax({type:n.type,url:n.url,data:a,dataType:"json",contentType:n.contentType,cache:!1,success(t){200===t.code?e(t.data):0===t.code?o.goLogin():i(t.msg)},error(t,e){i("网络异常")}})}))},appSource(){const t=navigator.userAgent,e=(navigator.appVersion,t.indexOf("Android")>-1||t.indexOf("Linux")>-1),n=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return e?"android":n?"ios":"H5"},goLogin(){},filterStr:t=>t=(t=(t=(t=(t=(t=(t=(t+="").replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&#39;")).replace(/"/g,"&quot;")).replace(/;/g,"")).replace(/--/g," "),getQueryString(t,e=window.window.location.search){const n=this,o=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=e.substr(1).match(o);return null!==i?n.filterStr(decodeURIComponent(i[2])):null},deepClone(t){let e,n=function(t){let e=Object.prototype.toString;return t instanceof Element?"element":{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[e.call(t)]}(t);if("array"===n)e=[];else{if("object"!==n)return t;e={}}if("array"===n)for(let n=0,o=t.length;n<o;n++)e.push(this.deepClone(t[n]));else if("object"===n)for(let n in t)e[n]=this.deepClone(t[n]);return e},randomInRange:(t,e)=>t+Math.floor(Math.random()*(e-t)),getBLen:t=>null==t?0:("string"!=typeof t&&(t+=""),t.replace(/[^\x00-\xff]/g,"01").length)}}).call(this,n(699))},701:function(t,e,n){"use strict";n(286);var o=n(41),i=n(700),a={name:"v-head",props:["myTitle"],data(){return{title:this.myTitle,appSource:""}},methods:{onClickLeft(){"票卡商城"===this.title?Object(o.a)("调用安卓或者ios方法返回"):this.$router.go(-1)}},created(){this.appSource=i.a.appSource()}},r=n(189),l=Object(r.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return"ios"!==this.appSource&&"android"!==this.appSource?e("div",[e("van-nav-bar",{attrs:{title:this.title,"left-text":"","left-arrow":"",fixed:!0},on:{"click-left":this.onClickLeft}}),this._v(" "),e("div",{staticStyle:{height:"46px"}})],1):this._e()}),[],!1,null,null,null);e.a=l.exports},708:function(t,e,n){var o=n(722);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,n(6).default)("3243bb8c",o,!0,{})},721:function(t,e,n){"use strict";var o=n(708);n.n(o).a},722:function(t,e,n){(e=n(5)(!1)).push([t.i,"\n#l-map[data-v-21f0cf9d] {\n    width: 100%;\n    height: 100vh;\n    overflow: hidden;\n    margin: 0;\n}\n",""]),t.exports=e},728:function(t,e,n){"use strict";n.r(e);var o={components:{vHead:n(701).a},data:()=>({myTitle:"惠生活",map:null,geolocation:"",city:"温州",point:"",pointONE:"",show:!0,isOverlay:!1,selectSite:!1,height:30,value:"",siteList:[{site:"桐岭站"},{site:"潘桥站"},{site:"动车南站"},{site:"新桥站"},{site:"德政站"},{site:"龙霞路站"},{site:"惠民路站"},{site:"当前位置"}],setInterval:null,geolocationControl:null,navigationControl:null}),mounted(){this.createMap()},methods:{createMap(){this.geolocation=new BMap.Geolocation,this.geolocation.getCurrentPosition(t=>{this.point=new BMap.Point(t.point.lng,t.point.lat),this.map=new BMap.Map("l-map",{enableHighResolution:!0}),this.map.enableInertialDragging(),this.map.centerAndZoom(this.point,15),this.map.setCurrentCity(this.city),this.map.enableScrollWheelZoom(!0),this.addControl(),this.createMarker()})},createMarker(){this.geolocation.getCurrentPosition(t=>{this.point=new BMap.Point(t.point.lng,t.point.lat);var e=new BMap.Marker(t.point);this.map.addOverlay(e),e.name="personalPositioning",e.disableMassClear()})},addControl(){this.navigationControl=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE,enableGeolocation:!0}),this.map.addControl(this.navigationControl),this.geolocationControl=new BMap.GeolocationControl({anchor:BMAP_ANCHOR_TOP_RIGHT,enableGeolocation:!0}),this.geolocationControl.addEventListener("locationSuccess",t=>{var e="";e+=t.addressComponent.province,e+=t.addressComponent.city,e+=t.addressComponent.district,e+=t.addressComponent.street,e+=t.addressComponent.streetNumber,console.log("当前定位地址为："+e)}),this.geolocationControl.addEventListener("locationError",t=>alert(t.message)),this.map.addControl(this.geolocationControl)},onClick(){this.map.clearOverlays(),new BMap.TransitRoute(this.map,{renderOptions:{map:this.map,panel:"r-result"}}).search("惠民路","洪殿-公交车站")},onRange(t){var e="";e=""!==this.pointONE?this.pointONE:this.point,this.map.clearOverlays();var n=new BMap.Circle(e,1e3,{fillColor:"blue",strokeWeight:1,fillOpacity:.3,strokeOpacity:.3});this.map.addOverlay(n),new BMap.LocalSearch(this.map,{renderOptions:{map:this.map,autoViewport:!1}}).searchNearby(t,e,1e3)},showPopup(){this.selectSite=!0},setSiteName(t){if(clearInterval(this.setInterval),"当前位置"===t)this.pointONE="",this.map.clearOverlays(),this.map.panTo(this.point),this.upDateMarker();else{this.map.clearOverlays(),this.pointONE=new BMap.Point(120.702428,27.984637);var e=new BMap.Marker(this.pointONE);this.map.addOverlay(e),this.map.panTo(this.pointONE)}this.value=t,this.selectSite=!1}}},i=(n(721),n(189)),a=Object(i.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-head",{attrs:{myTitle:this.myTitle}}),t._v(" "),n("div",{attrs:{id:"l-map"}}),t._v(" "),n("van-popup",{style:{height:this.height+"%"},attrs:{round:"",position:"bottom",overlay:t.isOverlay},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("van-field",{attrs:{label:"选择站点","is-link":"",readonly:"","input-align":"right"},on:{click:t.showPopup},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),n("button",{on:{click:t.onClick}},[t._v("公交")]),t._v(" "),n("button",{on:{click:function(e){return t.onRange("美食")}}},[t._v("美食")]),t._v(" "),n("button",{on:{click:function(e){return t.onRange("超市")}}},[t._v("超市")]),t._v(" "),n("button",{on:{click:function(e){return t.onRange("银行")}}},[t._v("银行")]),t._v(" "),n("button",{on:{click:function(e){return t.onRange("住宿")}}},[t._v("住宿")]),t._v(" "),n("button",{on:{click:function(e){return t.onRange("景点")}}},[t._v("景点")]),t._v(" "),n("button",{on:{click:function(e){return t.onRange("休闲")}}},[t._v("休闲")]),t._v(" "),n("div",{attrs:{id:"r-result"}})],1),t._v(" "),n("van-popup",{style:{width:"100%",height:"90%"},attrs:{round:"",position:"bottom"},model:{value:t.selectSite,callback:function(e){t.selectSite=e},expression:"selectSite"}},t._l(t.siteList,(function(e,o){return n("van-cell",{key:o,attrs:{title:e.site},on:{click:function(n){return t.setSiteName(e.site)}}})})),1)],1)}),[],!1,null,"21f0cf9d",null);e.default=a.exports}}]);